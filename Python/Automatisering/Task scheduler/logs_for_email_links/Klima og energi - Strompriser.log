Loaded .env file from: D:\Scripts\analyse\Telemark\Python\token.env
X_FUNCTIONS_KEY loaded successfully.
Loaded .env file from: D:\Scripts\analyse\Telemark\Python\token.env
GITHUB_TOKEN loaded successfully.
Script starting...
Working with file: Data/04_Klima og ressursforvaltning/Kraft og energi/Kraftpriser/entso-e/strompriser.csv
Checking for existing data...
Type of existing_df: <class 'pandas.core.frame.DataFrame'>
Latest date in existing data: 2025-06-20 00:00:00
Found 1631 existing records
Will fetch data from 2025-06-21 00:00:00 to 2025-06-22 00:00:00 (yesterday)
Fetching energy prices from ENTSO-E...
Successfully received response from ENTSO-E
Parsing XML response...
Found 2 TimeSeries elements
Processing period starting at 2025-06-20T22:00Z
Found 24 Point elements
Processing period starting at 2025-06-21T22:00Z
Found 24 Point elements
Total price data points collected: 48
After filtering out existing dates, 47 price records remain
After filtering out future dates, 19 price records remain
Fetching exchange rates...
Full API URL: https://data.norges-bank.no/api/data/EXR/B.EUR.NOK.SP?startPeriod=2025-06-21&endPeriod=2025-06-22&format=csv&bom=include&locale=no
Requesting exchange rates from 2025-06-21 to 2025-06-22
Response status code: 404
Response headers: {'Set-Cookie': 'JSESSIONID=A470AC349CC97D563B3D23480ED5D99A; Path=/FusionRegistry; HttpOnly; SameSite=Strict', 'Vary': 'Origin, Access-Control-Request-Method, Access-Control-Request-Headers, Accept,Accept-Language', 'Content-Disposition': 'inline; filename="EXR.csv"', 'X-XSS-Protection': '1; mode=block', 'X-Frame-Options': 'SAMEORIGIN', 'X-Content-Type-Options': 'nosniff', 'Referrer-Policy': 'strict-origin-when-cross-origin', 'Content-Type': 'application/xml;charset=UTF-8', 'Transfer-Encoding': 'chunked', 'Date': 'Mon, 23 Jun 2025 09:04:13 GMT', 'Keep-Alive': 'timeout=20', 'Connection': 'keep-alive', 'Strict-Transport-Security': 'max-age=31556926; includeSubDomains'}
Response preview: <?xml version='1.0' encoding='UTF-8'?>
<message:Error xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xml="http://www.w3.org/XML/1998/namespace" xmlns:message="http://www.sdmx.org/resources/sdmxml/schemas/v2_1/message" xmlns:com="http://www.sdmx.org/resources/sdmxml/schemas/v2_1/common">
  <message:ErrorMessage code="100">
    <com:Text>No data for data query against the dataflow: urn:sdmx:org.sdmx.infomodel.datastructure.Dataflow=NB:EXR(1.0)</com:Text>
  </message:ErrorMessage>
</me...
Could not fetch new exchange rates: 404 Client Error:  for url: https://data.norges-bank.no/api/data/EXR/B.EUR.NOK.SP?startPeriod=2025-06-21&endPeriod=2025-06-22&format=csv&bom=include&locale=no, using latest available rate...
Attempting direct URL method as fallback...
Direct fallback URL: https://data.norges-bank.no/api/data/EXR/B.EUR.NOK.SP?format=csv&startPeriod=2025-06-21&endPeriod=2025-06-22&bom=include&locale=no
Fallback response status: 404
Fallback method also failed: Fallback request failed with status 404
Using latest available rate from existing data: 11.598
Merging price and exchange rate data...
Exchange rates are available for dates: 0    2025-06-21
1    2025-06-22
Name: time, dtype: object
After filtering for dates with exchange rates, price data points: 19
Shape after merge: (19, 4)
Number of NaNs in eur_nok_rate after merge: 0


Errors:
Traceback (most recent call last):
  File "C:\Users\_eve1509\AppData\Local\anaconda3\envs\analyse\lib\site-packages\pandas\core\ops\array_ops.py", line 171, in _na_arithmetic_op
    result = func(left, right)
  File "C:\Users\_eve1509\AppData\Local\anaconda3\envs\analyse\lib\site-packages\pandas\core\computation\expressions.py", line 239, in evaluate
    return _evaluate(op, op_str, a, b)  # type: ignore[misc]
  File "C:\Users\_eve1509\AppData\Local\anaconda3\envs\analyse\lib\site-packages\pandas\core\computation\expressions.py", line 70, in _evaluate_standard
    return op(a, b)
TypeError: can't multiply sequence by non-int of type 'float'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\Scripts\analyse\Telemark\Python\Queries/04_Klima_og_energi/Kraft og energi/Strompriser/strompriser.py", line 312, in <module>
    df["price_nok"] = df["price_eur"] * df["eur_nok_rate"]
  File "C:\Users\_eve1509\AppData\Local\anaconda3\envs\analyse\lib\site-packages\pandas\core\ops\common.py", line 81, in new_method
    return method(self, other)
  File "C:\Users\_eve1509\AppData\Local\anaconda3\envs\analyse\lib\site-packages\pandas\core\arraylike.py", line 202, in __mul__
    return self._arith_method(other, operator.mul)
  File "C:\Users\_eve1509\AppData\Local\anaconda3\envs\analyse\lib\site-packages\pandas\core\series.py", line 6112, in _arith_method
    return base.IndexOpsMixin._arith_method(self, other, op)
  File "C:\Users\_eve1509\AppData\Local\anaconda3\envs\analyse\lib\site-packages\pandas\core\base.py", line 1348, in _arith_method
    result = ops.arithmetic_op(lvalues, rvalues, op)
  File "C:\Users\_eve1509\AppData\Local\anaconda3\envs\analyse\lib\site-packages\pandas\core\ops\array_ops.py", line 232, in arithmetic_op
    res_values = _na_arithmetic_op(left, right, op)  # type: ignore[arg-type]
  File "C:\Users\_eve1509\AppData\Local\anaconda3\envs\analyse\lib\site-packages\pandas\core\ops\array_ops.py", line 178, in _na_arithmetic_op
    result = _masked_arith_op(left, right, op)
  File "C:\Users\_eve1509\AppData\Local\anaconda3\envs\analyse\lib\site-packages\pandas\core\ops\array_ops.py", line 116, in _masked_arith_op
    result[mask] = op(xrav[mask], yrav[mask])
TypeError: can't multiply sequence by non-int of type 'float'

ERROR conda.cli.main_run:execute(125): `conda run python D:\Scripts\analyse\Telemark\Python\Queries/04_Klima_og_energi/Kraft og energi/Strompriser/strompriser.py` failed. (See above for error)
