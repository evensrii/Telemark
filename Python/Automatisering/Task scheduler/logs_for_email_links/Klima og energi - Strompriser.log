Loaded .env file from: D:\Scripts\analyse\Telemark\Python\token.env
X_FUNCTIONS_KEY loaded successfully.
Loaded .env file from: D:\Scripts\analyse\Telemark\Python\token.env
GITHUB_TOKEN loaded successfully.
Script starting...
Working with file: Data/04_Klima og ressursforvaltning/Kraft og energi/Kraftpriser/entso-e/strompriser.csv
Checking for existing data...
Type of existing_df: <class 'pandas.core.frame.DataFrame'>
Latest date in existing data: 2025-05-01 00:00:00
Found 1583 existing records
Will fetch data from 2025-05-02 00:00:00 to 2025-05-04 00:00:00 (yesterday)
Fetching energy prices from ENTSO-E...
Successfully received response from ENTSO-E
Parsing XML response...
Found 3 TimeSeries elements
Processing period starting at 2025-05-01T22:00Z
Found 24 Point elements
Processing period starting at 2025-05-02T22:00Z
Found 24 Point elements
Processing period starting at 2025-05-03T22:00Z
Found 24 Point elements
Total price data points collected: 72
After filtering out existing dates, 71 price records remain
Fetching exchange rates...
Merging price and exchange rate data...
Calculating daily averages...
Columns before renaming: ['date', 'price_eur', 'eur_nok_rate', 'price_nok']
Combining with existing data...
Columns in existing_df: ['time', 'EUR/MWh', 'kurs', 'NOK/MWh', 'NOK/KWh']
Columns in daily_avg_new: ['time', 'EUR/MWh', 'kurs', 'NOK/MWh', 'NOK/KWh']
Combined data now has 1589 records
Saved file to D:\Scripts\analyse\Telemark\Python\Temp\strompriser.csv
[2025-05-05 08:11:16] Row count changed: 1583 -> 1589

Added rows (showing up to 10):
EUR/MWh: 55.03857142857142, NOK/KWh: , NOK/MWh: , kurs: , time: 2025-05-02
EUR/MWh: 52.433076923076925, NOK/KWh: , NOK/MWh: , kurs: , time: 2025-05-03
EUR/MWh: 35.142222222222216, NOK/KWh: , NOK/MWh: , kurs: , time: 2025-05-04
EUR/MWh: 26.17705882352941, NOK/KWh: , NOK/MWh: , kurs: , time: 2025-05-05
EUR/MWh: 44.04363636363637, NOK/KWh: , NOK/MWh: , kurs: , time: 2025-05-06
EUR/MWh: 83.28399999999999, NOK/KWh: , NOK/MWh: , kurs: , time: 2025-05-07
File uploaded successfully: Data/04_Klima og ressursforvaltning/Kraft og energi/Kraftpriser/entso-e/strompriser.csv
Email notifications disabled. Updates for strompriser.csv were not sent.
Keeping CSV file: D:\Scripts\analyse\Telemark\Python\Temp\strompriser.csv
New data detected and pushed to GitHub.
New data status log written to D:\Scripts\analyse\Telemark\Python\Log\new_data_status_Klima_og_energi_-_Strompriser.log
Script completed successfully!

