Loaded .env file from: C:\Users\eve1509\OneDrive - Telemark fylkeskommune\Github\Telemark\Python\token.env

X_FUNCTIONS_KEY loaded successfully.

Loaded .env file from: C:\Users\eve1509\OneDrive - Telemark fylkeskommune\Github\Telemark\Python\token.env

GITHUB_TOKEN loaded successfully.

Script starting...

Working with file: Data/04_Klima og ressursforvaltning/Kraft og energi/Kraftpriser/entso-e/strompriser.csv

Checking for existing data...

Type of existing_df: <class 'pandas.core.frame.DataFrame'>

Latest date in existing data: 2024-11-20 00:00:00

Found 1421 existing records

Will fetch data from 2024-11-21 00:00:00 to 2025-01-13 00:00:00 (yesterday)

Fetching energy prices from ENTSO-E...

Successfully received response from ENTSO-E

Parsing XML response...

Found 54 TimeSeries elements

Processing period starting at 2024-11-20T23:00Z

Found 24 Point elements

Processing period starting at 2024-11-21T23:00Z

Found 24 Point elements

Processing period starting at 2024-11-22T23:00Z

Found 24 Point elements

Processing period starting at 2024-11-23T23:00Z

Found 24 Point elements

Processing period starting at 2024-11-24T23:00Z

Found 23 Point elements

Processing period starting at 2024-11-25T23:00Z

Found 24 Point elements

Processing period starting at 2024-11-26T23:00Z

Found 24 Point elements

Processing period starting at 2024-11-27T23:00Z

Found 24 Point elements

Processing period starting at 2024-11-28T23:00Z

Found 24 Point elements

Processing period starting at 2024-11-29T23:00Z

Found 24 Point elements

Processing period starting at 2024-11-30T23:00Z

Found 24 Point elements

Processing period starting at 2024-12-01T23:00Z

Found 24 Point elements

Processing period starting at 2024-12-02T23:00Z

Found 24 Point elements

Processing period starting at 2024-12-03T23:00Z

Found 24 Point elements

Processing period starting at 2024-12-04T23:00Z

Found 24 Point elements

Processing period starting at 2024-12-05T23:00Z

Found 24 Point elements

Processing period starting at 2024-12-06T23:00Z

Found 24 Point elements

Processing period starting at 2024-12-07T23:00Z

Found 24 Point elements

Processing period starting at 2024-12-08T23:00Z

Found 24 Point elements

Processing period starting at 2024-12-09T23:00Z

Found 24 Point elements

Processing period starting at 2024-12-10T23:00Z

Found 24 Point elements

Processing period starting at 2024-12-11T23:00Z

Found 24 Point elements

Processing period starting at 2024-12-12T23:00Z

Found 24 Point elements

Processing period starting at 2024-12-13T23:00Z

Found 23 Point elements

Processing period starting at 2024-12-14T23:00Z

Found 24 Point elements

Processing period starting at 2024-12-15T23:00Z

Found 24 Point elements

Processing period starting at 2024-12-16T23:00Z

Found 24 Point elements

Processing period starting at 2024-12-17T23:00Z

Found 24 Point elements

Processing period starting at 2024-12-18T23:00Z

Found 24 Point elements

Processing period starting at 2024-12-19T23:00Z

Found 23 Point elements

Processing period starting at 2024-12-20T23:00Z

Found 24 Point elements

Processing period starting at 2024-12-21T23:00Z

Found 24 Point elements

Processing period starting at 2024-12-22T23:00Z

Found 24 Point elements

Processing period starting at 2024-12-23T23:00Z

Found 24 Point elements

Processing period starting at 2024-12-24T23:00Z

Found 23 Point elements

Processing period starting at 2024-12-25T23:00Z

Found 24 Point elements

Processing period starting at 2024-12-26T23:00Z

Found 24 Point elements

Processing period starting at 2024-12-27T23:00Z

Found 23 Point elements

Processing period starting at 2024-12-28T23:00Z

Found 24 Point elements

Processing period starting at 2024-12-29T23:00Z

Found 24 Point elements

Processing period starting at 2024-12-30T23:00Z

Found 24 Point elements

Processing period starting at 2024-12-31T23:00Z

Found 24 Point elements

Processing period starting at 2025-01-01T23:00Z

Found 24 Point elements

Processing period starting at 2025-01-02T23:00Z

Found 24 Point elements

Processing period starting at 2025-01-03T23:00Z

Found 23 Point elements

Processing period starting at 2025-01-04T23:00Z

Found 24 Point elements

Processing period starting at 2025-01-05T23:00Z

Found 24 Point elements

Processing period starting at 2025-01-06T23:00Z

Found 24 Point elements

Processing period starting at 2025-01-07T23:00Z

Found 24 Point elements

Processing period starting at 2025-01-08T23:00Z

Found 24 Point elements

Processing period starting at 2025-01-09T23:00Z

Found 24 Point elements

Processing period starting at 2025-01-10T23:00Z

Found 24 Point elements

Processing period starting at 2025-01-11T23:00Z

Found 24 Point elements

Processing period starting at 2025-01-12T23:00Z

Found 24 Point elements

Total price data points collected: 1290

After filtering out existing dates, 1289 price records remain

Fetching exchange rates...

Merging price and exchange rate data...

Calculating daily averages...

Combining with existing data...

Combined data now has 1475 records



Errors:
Traceback (most recent call last):

  File "C:\Users\eve1509\OneDrive - Telemark fylkeskommune\Github\Telemark\Python\Queries/04_Klima_og_energi/Kraft og energi/Strompriser/strompriser.py", line 200, in <module>

    daily_avg.columns = ["time", "EUR/MWh", "kurs", "NOK/MWh"]

  File "C:\Users\eve1509\.conda\envs\analyse\lib\site-packages\pandas\core\generic.py", line 6002, in __setattr__

    return object.__setattr__(self, name, value)

  File "pandas\_libs\properties.pyx", line 69, in pandas._libs.properties.AxisProperty.__set__

  File "C:\Users\eve1509\.conda\envs\analyse\lib\site-packages\pandas\core\generic.py", line 730, in _set_axis

    self._mgr.set_axis(axis, labels)

  File "C:\Users\eve1509\.conda\envs\analyse\lib\site-packages\pandas\core\internals\managers.py", line 225, in set_axis

    self._validate_set_axis(axis, new_labels)

  File "C:\Users\eve1509\.conda\envs\analyse\lib\site-packages\pandas\core\internals\base.py", line 70, in _validate_set_axis

    raise ValueError(

ValueError: Length mismatch: Expected axis has 5 elements, new values have 4 elements


ERROR conda.cli.main_run:execute(124): `conda run python C:\Users\eve1509\OneDrive - Telemark fylkeskommune\Github\Telemark\Python\Queries/04_Klima_og_energi/Kraft og energi/Strompriser/strompriser.py` failed. (See above for error)
