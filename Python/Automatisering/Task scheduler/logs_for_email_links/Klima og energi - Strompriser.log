Loaded .env file from: D:\Scripts\analyse\Telemark\Python\token.env
X_FUNCTIONS_KEY loaded successfully.
Loaded .env file from: D:\Scripts\analyse\Telemark\Python\token.env
GITHUB_TOKEN loaded successfully.
Script starting...
Working with file: Data/04_Klima og ressursforvaltning/Kraft og energi/Kraftpriser/entso-e/strompriser.csv
Checking for existing data...
Type of existing_df: <class 'pandas.core.frame.DataFrame'>
Latest date in existing data: 2025-06-27 00:00:00
Found 1636 existing records
Will fetch data from 2025-06-28 00:00:00 to 2025-06-30 00:00:00 (yesterday)
Fetching energy prices from ENTSO-E...
Successfully received response from ENTSO-E
Parsing XML response...
Found 3 TimeSeries elements
Processing period starting at 2025-06-27T22:00Z
Found 24 Point elements
Processing period starting at 2025-06-28T22:00Z
Found 24 Point elements
Processing period starting at 2025-06-29T22:00Z
Found 24 Point elements
Total price data points collected: 72
After filtering out existing dates, 71 price records remain
After filtering out future dates, 38 price records remain
Fetching exchange rates...
Full API URL: https://data.norges-bank.no/api/data/EXR/B.EUR.NOK.SP?startPeriod=2025-06-28&endPeriod=2025-06-30&format=csv&bom=include&locale=no
Requesting exchange rates from 2025-06-28 to 2025-06-30
Response status code: 200
Response headers: {'Set-Cookie': 'JSESSIONID=515A3890BA9E0636D140A7222496C8E4; Path=/FusionRegistry; HttpOnly; SameSite=Strict', 'Vary': 'Origin, Access-Control-Request-Method, Access-Control-Request-Headers, Accept,Accept-Language', 'Content-Disposition': 'inline; filename="EXR.csv"', 'X-XSS-Protection': '1; mode=block', 'X-Frame-Options': 'SAMEORIGIN', 'X-Content-Type-Options': 'nosniff', 'Referrer-Policy': 'strict-origin-when-cross-origin', 'Content-Type': 'text/csv;charset=UTF-8', 'Date': 'Tue, 01 Jul 2025 06:11:02 GMT', 'Keep-Alive': 'timeout=20', 'Connection': 'keep-alive', 'Strict-Transport-Security': 'max-age=31556926; includeSubDomains', 'Content-Encoding': 'gzip', 'Transfer-Encoding': 'chunked'}
Response preview: Ã¯Â»Â¿FREQ;Frekvens;BASE_CUR;Basisvaluta;QUOTE_CUR;Kvoteringsvaluta;TENOR;LÃÂ¸petid;DECIMALS;CALCULATED;UNIT_MULT;Multiplikator;COLLECTION;Innsamlingstidspunkt;TIME_PERIOD;OBS_VALUE
B;Virkedag;EUR;Euro;NOK;Norske kroner;SP;Spot;4;false;0;Enheter;C;ECB concertation tidspunkt 14:15 CET;2025-06-30;11,8345
...
Full response saved to D:\Scripts\analyse\Telemark\Python\Temp\exchange_rate_response.txt
Exchange rate data shape: (1, 16)
Exchange rate columns: ['FREQ', 'Frekvens', 'BASE_CUR', 'Basisvaluta', 'QUOTE_CUR', 'Kvoteringsvaluta', 'TENOR', 'LÃÂ¸petid', 'DECIMALS', 'CALCULATED', 'UNIT_MULT', 'Multiplikator', 'COLLECTION', 'Innsamlingstidspunkt', 'TIME_PERIOD', 'OBS_VALUE']
First rows of exchange rate data:
  FREQ  Frekvens  ... TIME_PERIOD OBS_VALUE
0    B  Virkedag  ...  2025-06-30   11,8345

[1 rows x 16 columns]
Converted comma to period in exchange rates
Final exchange rate data:
        time  eur_nok_rate
0 2025-06-30       11.8345
Date range in exchange rate data: 2025-06-30 00:00:00 - 2025-06-30 00:00:00
Successfully fetched 1 exchange rate records
Merging price and exchange rate data...
Exchange rates are available for dates: 0    2025-06-30
Name: time, dtype: object
After filtering for dates with exchange rates, price data points: 18
Shape after merge: (18, 4)
Number of NaNs in eur_nok_rate after merge: 0
Calculating daily averages...
Sample data before grouping:
         date  price_eur  eur_nok_rate  price_nok
0  2025-06-30      -1.44       11.8345  -17.04168
1  2025-06-30      -1.28       11.8345  -15.14816
2  2025-06-30       0.04       11.8345    0.47338
3  2025-06-30       2.18       11.8345   25.79921
4  2025-06-30      45.34       11.8345  536.57623
Sample data after grouping:
         date  price_eur  eur_nok_rate   price_nok
0  2025-06-30  33.139444       11.8345  392.188755
Columns before renaming: ['date', 'price_eur', 'eur_nok_rate', 'price_nok']
Columns after renaming: ['time', 'EUR/MWh', 'kurs', 'NOK/MWh']
Sample data after renaming:
         time    EUR/MWh     kurs     NOK/MWh
0  2025-06-30  33.139444  11.8345  392.188755
Final prepared data:
         time    EUR/MWh     kurs     NOK/MWh   NOK/KWh
0  2025-06-30  33.139444  11.8345  392.188755  0.392189
Combining with existing data...
Columns in existing_df: ['time', 'EUR/MWh', 'kurs', 'NOK/MWh', 'NOK/KWh']
Columns in daily_avg_new: ['time', 'EUR/MWh', 'kurs', 'NOK/MWh', 'NOK/KWh']
Combined data now has 1637 records
Saved file to D:\Scripts\analyse\Telemark\Python\Temp\strompriser.csv
[2025-07-01 08:11:02] Row count changed: 1636 -> 1637

Added rows (showing up to 10):
EUR/MWh: 33.13944444444444, NOK/KWh: 0.39218875527777775, NOK/MWh: 392.1887552777778, kurs: 11.8345, time: 2025-06-30
File uploaded successfully: Data/04_Klima og ressursforvaltning/Kraft og energi/Kraftpriser/entso-e/strompriser.csv
Email notifications disabled. Updates for strompriser.csv were not sent.
Keeping CSV file: D:\Scripts\analyse\Telemark\Python\Temp\strompriser.csv
New data detected and pushed to GitHub.
New data status log written to D:\Scripts\analyse\Telemark\Python\Log\new_data_status_Klima_og_energi_-_Strompriser.log
Script completed successfully!

