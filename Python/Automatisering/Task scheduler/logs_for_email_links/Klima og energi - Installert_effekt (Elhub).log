Loaded .env file from: D:\Scripts\analyse\Telemark\Python\token.env
X_FUNCTIONS_KEY loaded successfully.
Loaded .env file from: D:\Scripts\analyse\Telemark\Python\token.env
GITHUB_TOKEN loaded successfully.
[2025-10-31 08:15:51] GITHUB_TOKEN loaded successfully.
[2025-10-31 08:15:51] Starting Elhub query for all Telemark municipalities (incremental mode)
[2025-10-31 08:15:51] Checking GitHub path: Data/04_Klima og ressursforvaltning/Kraft og energi/Elhub/Installert_kapasitet/installed_capacity.csv
[2025-10-31 08:15:52] Latest date found in existing installed_capacity.csv: 2025-10-30
[2025-10-31 08:15:52] Will query for data from: 2025-10-31
[2025-10-31 08:15:52] Will query up to: 2025-10-31

[2025-10-31 08:15:52] Querying municipality 4001 for new data...
[2025-10-31 08:15:52] Querying municipality 4001 for period 2025-10-31 to 2025-10-31
[2025-10-31 08:15:52] Querying URL: https://api.elhub.no/energy-data/v0/municipalities/4001?dataset=INSTALLED_CAPACITY_PER_METERING_POINT_TYPE_GROUP_MUNICIPALITY_DAILY&startDate=2025-10-31&endDate=2025-10-31 (attempt 1)
[2025-10-31 08:15:52] Error: Status code 400
[2025-10-31 08:15:52] Response: {"errors":[{"status":"400","title":"endDate must be after startDate","detail":"creationTime: 2025-10-31T08:15:52+01:00","links":{"self":"https://api.elhub.no/energy-data/v0/municipalities/4001?dataset=INSTALLED_CAPACITY_PER_METERING_POINT_TYPE_GROUP_MUNICIPALITY_DAILY&endDate=2025-10-31&startDate=2025-10-31"}}]}
[2025-10-31 08:15:52] Failed after 1 attempts.
[2025-10-31 08:15:53] Failed to get data for 4001 for 2025-10-31 to 2025-10-31

[2025-10-31 08:15:54] Querying municipality 4003 for new data...
[2025-10-31 08:15:54] Querying municipality 4003 for period 2025-10-31 to 2025-10-31
[2025-10-31 08:15:54] Querying URL: https://api.elhub.no/energy-data/v0/municipalities/4003?dataset=INSTALLED_CAPACITY_PER_METERING_POINT_TYPE_GROUP_MUNICIPALITY_DAILY&startDate=2025-10-31&endDate=2025-10-31 (attempt 1)
[2025-10-31 08:15:54] Error: Status code 400
[2025-10-31 08:15:54] Response: {"errors":[{"status":"400","title":"endDate must be after startDate","detail":"creationTime: 2025-10-31T08:15:54+01:00","links":{"self":"https://api.elhub.no/energy-data/v0/municipalities/4003?dataset=INSTALLED_CAPACITY_PER_METERING_POINT_TYPE_GROUP_MUNICIPALITY_DAILY&endDate=2025-10-31&startDate=2025-10-31"}}]}
[2025-10-31 08:15:54] Failed after 1 attempts.
[2025-10-31 08:15:54] Failed to get data for 4003 for 2025-10-31 to 2025-10-31

[2025-10-31 08:15:55] Querying municipality 4005 for new data...
[2025-10-31 08:15:55] Querying municipality 4005 for period 2025-10-31 to 2025-10-31
[2025-10-31 08:15:55] Querying URL: https://api.elhub.no/energy-data/v0/municipalities/4005?dataset=INSTALLED_CAPACITY_PER_METERING_POINT_TYPE_GROUP_MUNICIPALITY_DAILY&startDate=2025-10-31&endDate=2025-10-31 (attempt 1)
[2025-10-31 08:15:55] Error: Status code 400
[2025-10-31 08:15:55] Response: {"errors":[{"status":"400","title":"endDate must be after startDate","detail":"creationTime: 2025-10-31T08:15:55+01:00","links":{"self":"https://api.elhub.no/energy-data/v0/municipalities/4005?dataset=INSTALLED_CAPACITY_PER_METERING_POINT_TYPE_GROUP_MUNICIPALITY_DAILY&endDate=2025-10-31&startDate=2025-10-31"}}]}
[2025-10-31 08:15:55] Failed after 1 attempts.
[2025-10-31 08:15:55] Failed to get data for 4005 for 2025-10-31 to 2025-10-31

[2025-10-31 08:15:56] Querying municipality 4010 for new data...
[2025-10-31 08:15:56] Querying municipality 4010 for period 2025-10-31 to 2025-10-31
[2025-10-31 08:15:56] Querying URL: https://api.elhub.no/energy-data/v0/municipalities/4010?dataset=INSTALLED_CAPACITY_PER_METERING_POINT_TYPE_GROUP_MUNICIPALITY_DAILY&startDate=2025-10-31&endDate=2025-10-31 (attempt 1)
[2025-10-31 08:15:56] Error: Status code 400
[2025-10-31 08:15:56] Response: {"errors":[{"status":"400","title":"endDate must be after startDate","detail":"creationTime: 2025-10-31T08:15:56+01:00","links":{"self":"https://api.elhub.no/energy-data/v0/municipalities/4010?dataset=INSTALLED_CAPACITY_PER_METERING_POINT_TYPE_GROUP_MUNICIPALITY_DAILY&endDate=2025-10-31&startDate=2025-10-31"}}]}
[2025-10-31 08:15:56] Failed after 1 attempts.
[2025-10-31 08:15:56] Failed to get data for 4010 for 2025-10-31 to 2025-10-31

[2025-10-31 08:15:57] Querying municipality 4012 for new data...
[2025-10-31 08:15:57] Querying municipality 4012 for period 2025-10-31 to 2025-10-31
[2025-10-31 08:15:57] Querying URL: https://api.elhub.no/energy-data/v0/municipalities/4012?dataset=INSTALLED_CAPACITY_PER_METERING_POINT_TYPE_GROUP_MUNICIPALITY_DAILY&startDate=2025-10-31&endDate=2025-10-31 (attempt 1)
[2025-10-31 08:15:57] Error: Status code 400
[2025-10-31 08:15:57] Response: {"errors":[{"status":"400","title":"endDate must be after startDate","detail":"creationTime: 2025-10-31T08:15:57+01:00","links":{"self":"https://api.elhub.no/energy-data/v0/municipalities/4012?dataset=INSTALLED_CAPACITY_PER_METERING_POINT_TYPE_GROUP_MUNICIPALITY_DAILY&endDate=2025-10-31&startDate=2025-10-31"}}]}
[2025-10-31 08:15:57] Failed after 1 attempts.
[2025-10-31 08:15:57] Failed to get data for 4012 for 2025-10-31 to 2025-10-31

[2025-10-31 08:15:58] Querying municipality 4014 for new data...
[2025-10-31 08:15:58] Querying municipality 4014 for period 2025-10-31 to 2025-10-31
[2025-10-31 08:15:58] Querying URL: https://api.elhub.no/energy-data/v0/municipalities/4014?dataset=INSTALLED_CAPACITY_PER_METERING_POINT_TYPE_GROUP_MUNICIPALITY_DAILY&startDate=2025-10-31&endDate=2025-10-31 (attempt 1)
[2025-10-31 08:15:58] Error: Status code 400
[2025-10-31 08:15:58] Response: {"errors":[{"status":"400","title":"endDate must be after startDate","detail":"creationTime: 2025-10-31T08:15:58+01:00","links":{"self":"https://api.elhub.no/energy-data/v0/municipalities/4014?dataset=INSTALLED_CAPACITY_PER_METERING_POINT_TYPE_GROUP_MUNICIPALITY_DAILY&endDate=2025-10-31&startDate=2025-10-31"}}]}
[2025-10-31 08:15:58] Failed after 1 attempts.
[2025-10-31 08:15:58] Failed to get data for 4014 for 2025-10-31 to 2025-10-31

[2025-10-31 08:15:59] Querying municipality 4016 for new data...
[2025-10-31 08:15:59] Querying municipality 4016 for period 2025-10-31 to 2025-10-31
[2025-10-31 08:15:59] Querying URL: https://api.elhub.no/energy-data/v0/municipalities/4016?dataset=INSTALLED_CAPACITY_PER_METERING_POINT_TYPE_GROUP_MUNICIPALITY_DAILY&startDate=2025-10-31&endDate=2025-10-31 (attempt 1)
[2025-10-31 08:15:59] Error: Status code 400
[2025-10-31 08:15:59] Response: {"errors":[{"status":"400","title":"endDate must be after startDate","detail":"creationTime: 2025-10-31T08:15:59+01:00","links":{"self":"https://api.elhub.no/energy-data/v0/municipalities/4016?dataset=INSTALLED_CAPACITY_PER_METERING_POINT_TYPE_GROUP_MUNICIPALITY_DAILY&endDate=2025-10-31&startDate=2025-10-31"}}]}
[2025-10-31 08:15:59] Failed after 1 attempts.
[2025-10-31 08:15:59] Failed to get data for 4016 for 2025-10-31 to 2025-10-31

[2025-10-31 08:16:00] Querying municipality 4018 for new data...
[2025-10-31 08:16:00] Querying municipality 4018 for period 2025-10-31 to 2025-10-31
[2025-10-31 08:16:00] Querying URL: https://api.elhub.no/energy-data/v0/municipalities/4018?dataset=INSTALLED_CAPACITY_PER_METERING_POINT_TYPE_GROUP_MUNICIPALITY_DAILY&startDate=2025-10-31&endDate=2025-10-31 (attempt 1)
[2025-10-31 08:16:00] Error: Status code 400
[2025-10-31 08:16:00] Response: {"errors":[{"status":"400","title":"endDate must be after startDate","detail":"creationTime: 2025-10-31T08:16:00+01:00","links":{"self":"https://api.elhub.no/energy-data/v0/municipalities/4018?dataset=INSTALLED_CAPACITY_PER_METERING_POINT_TYPE_GROUP_MUNICIPALITY_DAILY&endDate=2025-10-31&startDate=2025-10-31"}}]}
[2025-10-31 08:16:00] Failed after 1 attempts.
[2025-10-31 08:16:00] Failed to get data for 4018 for 2025-10-31 to 2025-10-31

[2025-10-31 08:16:01] Querying municipality 4020 for new data...
[2025-10-31 08:16:01] Querying municipality 4020 for period 2025-10-31 to 2025-10-31
[2025-10-31 08:16:01] Querying URL: https://api.elhub.no/energy-data/v0/municipalities/4020?dataset=INSTALLED_CAPACITY_PER_METERING_POINT_TYPE_GROUP_MUNICIPALITY_DAILY&startDate=2025-10-31&endDate=2025-10-31 (attempt 1)
[2025-10-31 08:16:01] Error: Status code 400
[2025-10-31 08:16:01] Response: {"errors":[{"status":"400","title":"endDate must be after startDate","detail":"creationTime: 2025-10-31T08:16:01+01:00","links":{"self":"https://api.elhub.no/energy-data/v0/municipalities/4020?dataset=INSTALLED_CAPACITY_PER_METERING_POINT_TYPE_GROUP_MUNICIPALITY_DAILY&endDate=2025-10-31&startDate=2025-10-31"}}]}
[2025-10-31 08:16:01] Failed after 1 attempts.
[2025-10-31 08:16:01] Failed to get data for 4020 for 2025-10-31 to 2025-10-31

[2025-10-31 08:16:02] Querying municipality 4022 for new data...
[2025-10-31 08:16:02] Querying municipality 4022 for period 2025-10-31 to 2025-10-31
[2025-10-31 08:16:02] Querying URL: https://api.elhub.no/energy-data/v0/municipalities/4022?dataset=INSTALLED_CAPACITY_PER_METERING_POINT_TYPE_GROUP_MUNICIPALITY_DAILY&startDate=2025-10-31&endDate=2025-10-31 (attempt 1)
[2025-10-31 08:16:03] Error: Status code 400
[2025-10-31 08:16:03] Response: {"errors":[{"status":"400","title":"endDate must be after startDate","detail":"creationTime: 2025-10-31T08:16:03+01:00","links":{"self":"https://api.elhub.no/energy-data/v0/municipalities/4022?dataset=INSTALLED_CAPACITY_PER_METERING_POINT_TYPE_GROUP_MUNICIPALITY_DAILY&endDate=2025-10-31&startDate=2025-10-31"}}]}
[2025-10-31 08:16:03] Failed after 1 attempts.
[2025-10-31 08:16:03] Failed to get data for 4022 for 2025-10-31 to 2025-10-31

[2025-10-31 08:16:04] Querying municipality 4024 for new data...
[2025-10-31 08:16:04] Querying municipality 4024 for period 2025-10-31 to 2025-10-31
[2025-10-31 08:16:04] Querying URL: https://api.elhub.no/energy-data/v0/municipalities/4024?dataset=INSTALLED_CAPACITY_PER_METERING_POINT_TYPE_GROUP_MUNICIPALITY_DAILY&startDate=2025-10-31&endDate=2025-10-31 (attempt 1)
[2025-10-31 08:16:04] Error: Status code 400
[2025-10-31 08:16:04] Response: {"errors":[{"status":"400","title":"endDate must be after startDate","detail":"creationTime: 2025-10-31T08:16:04+01:00","links":{"self":"https://api.elhub.no/energy-data/v0/municipalities/4024?dataset=INSTALLED_CAPACITY_PER_METERING_POINT_TYPE_GROUP_MUNICIPALITY_DAILY&endDate=2025-10-31&startDate=2025-10-31"}}]}
[2025-10-31 08:16:04] Failed after 1 attempts.
[2025-10-31 08:16:04] Failed to get data for 4024 for 2025-10-31 to 2025-10-31

[2025-10-31 08:16:05] Querying municipality 4026 for new data...
[2025-10-31 08:16:05] Querying municipality 4026 for period 2025-10-31 to 2025-10-31
[2025-10-31 08:16:05] Querying URL: https://api.elhub.no/energy-data/v0/municipalities/4026?dataset=INSTALLED_CAPACITY_PER_METERING_POINT_TYPE_GROUP_MUNICIPALITY_DAILY&startDate=2025-10-31&endDate=2025-10-31 (attempt 1)
[2025-10-31 08:16:05] Error: Status code 400
[2025-10-31 08:16:05] Response: {"errors":[{"status":"400","title":"endDate must be after startDate","detail":"creationTime: 2025-10-31T08:16:05+01:00","links":{"self":"https://api.elhub.no/energy-data/v0/municipalities/4026?dataset=INSTALLED_CAPACITY_PER_METERING_POINT_TYPE_GROUP_MUNICIPALITY_DAILY&endDate=2025-10-31&startDate=2025-10-31"}}]}
[2025-10-31 08:16:05] Failed after 1 attempts.
[2025-10-31 08:16:05] Failed to get data for 4026 for 2025-10-31 to 2025-10-31

[2025-10-31 08:16:06] Querying municipality 4028 for new data...
[2025-10-31 08:16:06] Querying municipality 4028 for period 2025-10-31 to 2025-10-31
[2025-10-31 08:16:06] Querying URL: https://api.elhub.no/energy-data/v0/municipalities/4028?dataset=INSTALLED_CAPACITY_PER_METERING_POINT_TYPE_GROUP_MUNICIPALITY_DAILY&startDate=2025-10-31&endDate=2025-10-31 (attempt 1)
[2025-10-31 08:16:06] Error: Status code 400
[2025-10-31 08:16:06] Response: {"errors":[{"status":"400","title":"endDate must be after startDate","detail":"creationTime: 2025-10-31T08:16:06+01:00","links":{"self":"https://api.elhub.no/energy-data/v0/municipalities/4028?dataset=INSTALLED_CAPACITY_PER_METERING_POINT_TYPE_GROUP_MUNICIPALITY_DAILY&endDate=2025-10-31&startDate=2025-10-31"}}]}
[2025-10-31 08:16:06] Failed after 1 attempts.
[2025-10-31 08:16:06] Failed to get data for 4028 for 2025-10-31 to 2025-10-31

[2025-10-31 08:16:07] Querying municipality 4030 for new data...
[2025-10-31 08:16:07] Querying municipality 4030 for period 2025-10-31 to 2025-10-31
[2025-10-31 08:16:07] Querying URL: https://api.elhub.no/energy-data/v0/municipalities/4030?dataset=INSTALLED_CAPACITY_PER_METERING_POINT_TYPE_GROUP_MUNICIPALITY_DAILY&startDate=2025-10-31&endDate=2025-10-31 (attempt 1)
[2025-10-31 08:16:07] Error: Status code 400
[2025-10-31 08:16:07] Response: {"errors":[{"status":"400","title":"endDate must be after startDate","detail":"creationTime: 2025-10-31T08:16:07+01:00","links":{"self":"https://api.elhub.no/energy-data/v0/municipalities/4030?dataset=INSTALLED_CAPACITY_PER_METERING_POINT_TYPE_GROUP_MUNICIPALITY_DAILY&endDate=2025-10-31&startDate=2025-10-31"}}]}
[2025-10-31 08:16:07] Failed after 1 attempts.
[2025-10-31 08:16:07] Failed to get data for 4030 for 2025-10-31 to 2025-10-31

[2025-10-31 08:16:08] Querying municipality 4032 for new data...
[2025-10-31 08:16:08] Querying municipality 4032 for period 2025-10-31 to 2025-10-31
[2025-10-31 08:16:08] Querying URL: https://api.elhub.no/energy-data/v0/municipalities/4032?dataset=INSTALLED_CAPACITY_PER_METERING_POINT_TYPE_GROUP_MUNICIPALITY_DAILY&startDate=2025-10-31&endDate=2025-10-31 (attempt 1)
[2025-10-31 08:16:08] Error: Status code 400
[2025-10-31 08:16:08] Response: {"errors":[{"status":"400","title":"endDate must be after startDate","detail":"creationTime: 2025-10-31T08:16:08+01:00","links":{"self":"https://api.elhub.no/energy-data/v0/municipalities/4032?dataset=INSTALLED_CAPACITY_PER_METERING_POINT_TYPE_GROUP_MUNICIPALITY_DAILY&endDate=2025-10-31&startDate=2025-10-31"}}]}
[2025-10-31 08:16:08] Failed after 1 attempts.
[2025-10-31 08:16:08] Failed to get data for 4032 for 2025-10-31 to 2025-10-31

[2025-10-31 08:16:09] Querying municipality 4034 for new data...
[2025-10-31 08:16:09] Querying municipality 4034 for period 2025-10-31 to 2025-10-31
[2025-10-31 08:16:09] Querying URL: https://api.elhub.no/energy-data/v0/municipalities/4034?dataset=INSTALLED_CAPACITY_PER_METERING_POINT_TYPE_GROUP_MUNICIPALITY_DAILY&startDate=2025-10-31&endDate=2025-10-31 (attempt 1)
[2025-10-31 08:16:09] Error: Status code 400
[2025-10-31 08:16:09] Response: {"errors":[{"status":"400","title":"endDate must be after startDate","detail":"creationTime: 2025-10-31T08:16:09+01:00","links":{"self":"https://api.elhub.no/energy-data/v0/municipalities/4034?dataset=INSTALLED_CAPACITY_PER_METERING_POINT_TYPE_GROUP_MUNICIPALITY_DAILY&endDate=2025-10-31&startDate=2025-10-31"}}]}
[2025-10-31 08:16:09] Failed after 1 attempts.
[2025-10-31 08:16:09] Failed to get data for 4034 for 2025-10-31 to 2025-10-31

[2025-10-31 08:16:10] Querying municipality 4036 for new data...
[2025-10-31 08:16:10] Querying municipality 4036 for period 2025-10-31 to 2025-10-31
[2025-10-31 08:16:10] Querying URL: https://api.elhub.no/energy-data/v0/municipalities/4036?dataset=INSTALLED_CAPACITY_PER_METERING_POINT_TYPE_GROUP_MUNICIPALITY_DAILY&startDate=2025-10-31&endDate=2025-10-31 (attempt 1)
[2025-10-31 08:16:10] Error: Status code 400
[2025-10-31 08:16:10] Response: {"errors":[{"status":"400","title":"endDate must be after startDate","detail":"creationTime: 2025-10-31T08:16:10+01:00","links":{"self":"https://api.elhub.no/energy-data/v0/municipalities/4036?dataset=INSTALLED_CAPACITY_PER_METERING_POINT_TYPE_GROUP_MUNICIPALITY_DAILY&endDate=2025-10-31&startDate=2025-10-31"}}]}
[2025-10-31 08:16:10] Failed after 1 attempts.
[2025-10-31 08:16:10] Failed to get data for 4036 for 2025-10-31 to 2025-10-31
Saved file to D:\Scripts\analyse\Telemark\Python\Temp\installed_capacity.csv
[2025-10-31 08:16:12] No new data to upload. Skipping GitHub update.
Keeping CSV file: D:\Scripts\analyse\Telemark\Python\Temp\installed_capacity.csv

[2025-10-31 08:16:15] Combined file processed and uploaded via handle_output_data
[2025-10-31 08:16:15] Total records in combined file: 82257
[2025-10-31 08:16:15] New data status log written to D:\Scripts\analyse\Telemark\Python\Log\new_data_status_Klima_og_energi_-_Installert_effekt_(Elhub).log

[2025-10-31 08:16:15] Query completed

